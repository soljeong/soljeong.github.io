- 수업 진도
- 교재
	- microsoft learn
	- kaggle learn
	- pytorch
	- 파이토치 교재 - 밀리
# 구글 코랩
- 구글 드라이브 폴더를 vs code에서 열어서 바로 편집하면 어떻게 되는지?
# 국민대
- [ ] epoch마다 loss 변하는거 그래프
- [x] 어제 추가한 부분 문단 정리
- [x] 노트북 실행 환경이 코랩인지 아닌지 확인하는 방법 있나?
```python
try:
    from google.colab import drive

    drive.mount('/content/drive')
    dir_path = '/content/drive/MyDrive/dacon/csv/'
    print("노트북은 Google Colab에서 실행 중입니다.")

except:
    dir_path = './csv/'
    print("노트북은 Google Colab이 아닌 환경에서 실행 중입니다.")

```
- [ ] eda를 위해. 행렬곱 사용?
- 평가를 하기는 해야하는데
	- 케이스 기준 슬라이스?
## train-test split 성철님
```python
#학습, 검증 분리
# 이코드 그대로 복사해서 (주석빼고) gpt에게 이 코드 해석해줘 하면 자세히 알려줍니다!
train, test = [], []
apply_train_groupby = apply_train.groupby('resume_seq')['recruitment_seq'].apply(list)
# uid에는 resume가 , iid에는 recruiment가 들어간다.
for uid, iids in zip(apply_train_groupby.index.tolist(), apply_train_groupby.values.tolist()):
    # 보시는 대로 iid의 마지막 원소를 제외하고 train에 [resume, recruimet]로 append 된다.
    for iid in iids[:-1]:
        train.append([uid,iid])
    # 나머지 하나는 test에 append 시킴
    test.append([uid, iids[-1]])
```
- 모든 유저는 최소 2건 이상 케이스 있음
- 각각 유저별로 마지막 한건의 아이템 선택을 테스트로 빼놓는다.
- 치우치면 어떡하지?
## eval
- train data case인데, model이 6위이하로 판단할 수도 있잖아
- 리콜 함수 다시 읽어보는거
- 스플릿 한 다음에, 에포크 한번 끝날때마다 테스트 셋 평가
- 여기서의 평가는 0/1로 맞추면 되는거니까. 이게 높은걸로 하면 되겠네
- 모델, 평가
## split
- 매트릭스 모양을 유지하면서 둘로 나눈다.
```python
import numpy as np

def train_test_split(user_item_matrix, test_size=0.2, seed=None):
    """
    user_item_matrix: 사용자-아이템 상호작용이 기록된 NumPy 행렬
    test_size: 각 사용자에 대해 테스트 세트로 설정할 상호작용의 비율
    seed: 난수 시드값 (재현가능한 결과를 위해)

    반환값: train_matrix, test_matrix
    """
    np.random.seed(seed)  # 재현가능성을 위한 시드 설정
    train_matrix = user_item_matrix.copy()
    test_matrix = np.zeros(user_item_matrix.shape)

    for user in range(user_item_matrix.shape[0]):
        positive_interactions = np.where(user_item_matrix[user, :] > 0)[0]
        test_interactions = np.random.choice(positive_interactions, 
                                             size=int(len(positive_interactions) * test_size), 
                                             replace=False)

        # 선택된 상호작용을 테스트 세트로 설정하고 훈련 세트에서 제거
        train_matrix[user, test_interactions] = 0
        test_matrix[user, test_interactions] = user_item_matrix[user, test_interactions]
    
    # True/False 행렬로 변환된 상태에서 반환하거나 0과 1로 변환할 수 있습니다.
    return train_matrix, test_matrix

# 예시 사용자-아이템 행렬
user_item_matrix = np.random.randint(0, 5, size=(100, 200))

# 훈련 세트와 테스트 세트로 분리
train_matrix, test_matrix = train_test_split(user_item_matrix, test_size=0.2, seed=42)

print(f"Train matrix shape: {train_matrix.shape}")
print(f"Test matrix shape: {test_matrix.shape}")

```



##  breakpoint 쓸 줄 몰라